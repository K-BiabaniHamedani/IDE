function [W, PFIT, sol] = fobj_Dome1410Bar_Frequency(X, se1, se2)

B = [1,2;2,3;3,4;4,5;5,6;6,7;8,9;9,10;10,11;11,12;12,13;2,8;3,9;4,10;5,11;6,12;7,13;2,9;3,10;4,11;5,12;6,13;1,8;1,14;2,15;3,16;4,17;5,18;6,19;8,21;9,22;10,23;11,24;12,25;13,26;8,14;9,15;10,16;11,17;12,18;13,19;8,15;9,16;10,17;11,18;12,19;13,20;14,15;15,16;16,17;17,18;18,19;19,20;21,22;22,23;23,24;24,25;25,26;15,21;16,22;17,23;18,24;19,25;20,26;15,22;16,23;17,24;18,25;19,26;14,21;14,27;15,28;16,29;17,30;18,31;19,32;21,34;22,35;23,36;24,37;25,38;26,39;21,27;22,28;23,29;24,30;25,31;26,32;21,28;22,29;23,30;24,31;25,32;26,33];
nodes = [1,0,4;3,0,3.75000000000000;5,0,3.25000000000000;7,0,2.75000000000000;9,0,2;11,0,1.25000000000000;13,0,0;1.98900000000000,0.209000000000000,3;3.97800000000000,0.418000000000000,2.75000000000000;5.96700000000000,0.627000000000000,2.25000000000000;7.95600000000000,0.836000000000000,1.75000000000000;9.94500000000000,1.04530000000000,1;11.9340000000000,1.25430000000000,-0.500000000000000;0.978147600733806,0.207911690817759,4;2.93444280220142,0.623735072453278,3.75000000000000;4.89073800366903,1.03955845408880,3.25000000000000;6.84703320513664,1.45538183572432,2.75000000000000;8.80332840660425,1.87120521735983,2;10.7596236080719,2.28702859899535,1.25000000000000;12.7159188095395,2.70285198063087,0;1.90208203447863,0.617969201589889,3;3.80416406895726,1.23593840317978,2.75000000000000;5.70624610343588,1.85390760476967,2.25000000000000;7.60832813791451,2.47187680635955,1.75000000000000;9.51034779888590,3.09013945222966,1;11.4124298333645,3.70810865381955,-0.500000000000000;0.913545457642601,0.406736643075800,4;2.74063637292780,1.22020992922740,3.75000000000000;4.56772728821300,2.03368321537900,3.25000000000000;6.39481820349821,2.84715650153060,2.75000000000000;8.22190911878341,3.66062978768220,2;10.0490000340686,4.47410307383380,1.25000000000000;11.8760909493538,5.28757635998540,0;1.73203395684829,0.999930183725070,3;3.46406791369658,1.99986036745014,2.75000000000000;5.19610187054487,2.99979055117521,2.25000000000000;6.92813582739316,3.99972073490028,1.75000000000000;8.66004776324853,4.99992498226264,1;10.3920817200968,5.99985516598771,-0.500000000000000];
f = [1;2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;22;23;24;25;26;27;28;29;30;31;32;33;34;35;36;37;38;39;40;41;42;43;44;45;46;47;48;49;50;51;52;53;54;55;56;57;61;62;63;64;65;66;67;68;69;70;71;72;73;74;75;76;77;78;79;80;81;82;83;84;85;86;87;88;89;90;91;92;93;94;95;96;100;101;102;103;104;105;106;107;108;109;110;111;112;113;114;115;116;117];

E = 20e10;
Density = 7850;
Mass = 100;
minfrq = [7 9];
FF = zeros(117,117);
MM = zeros(117,117);
W = 0;
AA = [X';X'];

for i = 1:94
    XTOOL = nodes(B(i,2),1)-nodes(B(i,1),1);
    YTOOL = nodes(B(i,2),2)-nodes(B(i,1),2);
    ZTOOL = nodes(B(i,2),3)-nodes(B(i,1),3);
    ELEMTOOL = sqrt(XTOOL^2+YTOOL^2+ZTOOL^2);
    roi = sqrt(nodes(B(i,1),1)^2+nodes(B(i,1),2)^2);
    roj = sqrt(nodes(B(i,2),1)^2+nodes(B(i,2),2)^2);
    loi = nodes(B(i,1),1)/roi;
    moi = nodes(B(i,1),2)/roi;
    loj = nodes(B(i,2),1)/roj;
    moj = nodes(B(i,2),2)/roj;
    Roi = [loi -moi 0; moi loi 0; 0 0 1];
    Roj = [loj -moj 0; moj loj 0; 0 0 1];
    R = [Roi zeros(3,3);zeros(3,3) Roj];
    XT = XTOOL/ELEMTOOL;
    YT = YTOOL/ELEMTOOL;
    ZT = ZTOOL/ELEMTOOL;
    se = [XT^2,XT*YT,XT*ZT;XT*YT,YT^2,YT*ZT;XT*ZT,YT*ZT,ZT^2];
    I2 = (B(i,1)-1)*3;
    H2 = (B(i,2)-1)*3;
    EAL = AA(i,1)*E/ELEMTOOL;
    APL6 = AA(i,1)*Density*ELEMTOOL/6;
    Weight = AA(i,1)*ELEMTOOL*Density;
    W = W+15*Weight;
    SE = EAL*[se -se;-se se];
    K_cylindrical_coordinate = R'*SE*R;
    elementdof = [I2+1 I2+2 I2+3 H2+1 H2+2 H2+3];
    FF(elementdof,elementdof) = FF(elementdof,elementdof)+K_cylindrical_coordinate;
    ME = APL6*[2 0 0 1 0 0;0 2 0 0 1 0;0 0 2 0 0 1;1 0 0 2 0 0;0 1 0 0 2 0;0 0 1 0 0 2];
    M_cylindrical_coordinate = R'*ME*R;
    MM(elementdof,elementdof) = MM(elementdof,elementdof)+M_cylindrical_coordinate;
end

for j = 1:39
    MM(3*j-2,3*j-2) = MM(3*j-2,3*j-2)+Mass;
    MM(3*j-1,3*j-1) = MM(3*j-1,3*j-1)+Mass;
    MM(3*j,3*j) = MM(3*j,3*j)+Mass;
end

MM = MM(f,f);
FF = FF(f,f);
AK = FF(37:72,37:72);
AM = MM(37:72,37:72);
BK = FF(1:36,37:72);
BM = MM(1:36,37:72);
sw = [];

for J = 1:14
    LANDA1 = complex(cos(2*J*pi/30),sin(2*J*pi/30));
    LANDA2 = complex(cos(2*J*pi/30),-sin(2*J*pi/30));
    kj = AK+LANDA1*BK+LANDA2*BK';
    mj = AM+LANDA1*BM+LANDA2*BM';
    sw = [sw;sqrt(real(eig(kj,mj)))/(2*pi)'];
end

sw = [sw;sw];
LANDA1 = -1;
kj = AK+LANDA1*BK+LANDA1*BK';
mj = AM+LANDA1*BM+LANDA1*BM';
sw = [sw;sqrt(real(eig(kj,mj)))/(2*pi)'];
LANDA1 = 1;
kj = AK+LANDA1*BK+LANDA1*BK';
mj = AM+LANDA1*BM+LANDA1*BM';
sw = [sw;sqrt(real(eig(kj,mj)))/(2*pi)'];
Fr = sort(sw);
Frequencies = Fr(1:5,1);
penalty = 0;
penalty = penalty+max(0,(1-(Frequencies(1,1)/minfrq(1))))+max(0,(1-(Frequencies(3,1)/minfrq(2))));
e1 = 2.5;
e2 = 0.5;
e3 = 0.5;

if se1>0.95*se2
    e1 = 200;
end

ppenalty = (1+e1*penalty)^(e2+e3*(se1/se2));
PFIT = W*ppenalty;

%% SOL
sol.Penalized_weight=PFIT;% kg
sol.weight=W;
sol.penalty=penalty;
sol.penalty_coefficient=ppenalty;
sol.A=AA'.*1e4;% cm^2
sol.x=X;
sol.omega=Frequencies;
sol.e1=e1;
sol.e2=e2;
sol.e3=e3;
sol.connectivity_1410bar=B;
sol.Coordinate_1410bar=nodes;
sol.load_1410bar=f;
end